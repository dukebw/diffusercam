\documentclass[final]{cvpr}

% NOTE(brendan):
% https://tex.stackexchange.com/questions/398223/tikz-gives-error-command-everyshipouthook-already-defined/398269
\makeatletter
\@namedef{ver@everyshi.sty}{}
\makeatother
\usepackage{tikz}
\usepackage{times}
\usepackage{epsfig}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}

% Include other packages here, before hyperref.
\usepackage[normalem]{ulem}
\usepackage{siunitx}

% NOTE(brendan): my packages
\usepackage{bbm}  % for \mathbbm{1}
\usepackage{bm}  % for more powerful bold symbols https://tex.stackexchange.com/a/596
\usepackage{caption}
\captionsetup[table]{skip=5pt}  % space between table and caption https://tex.stackexchange.com/a/2836
\usepackage{booktabs}
\usepackage{pifont}  % for dingbats checkmark and xmark

% If you comment hyperref and then uncomment it, you should delete
% egpaper.aux before re-running latex.  (Or just hit 'q' on the first latex
% run, let it finish, and you should be clear).
\usepackage[pagebackref=true,breaklinks=true,letterpaper=true,colorlinks,bookmarks=false]{hyperref}

% NOTE(brendan): my macros
% https://tex.stackexchange.com/a/217624
\makeatletter
\newcommand*{\transpose}{%
	{\mathpalette\@transpose{}}%
}
\newcommand*{\@transpose}[2]{%
	% #1: math style
	% #2: unused
	\raisebox{\depth}{$\m@th#1\intercal$}%
}
\makeatother

% \makeatletter                  % You do not need to write [htpb] all the time
% \renewcommand\fps@figure{htbp} %
% \renewcommand\fps@table{htbp}  %
% \makeatother                   %

\def\cvprPaperID{3473} % *** Enter the CVPR Paper ID here
\def\confYear{CVPR 2021}

\newcommand{\myparagraph}[1]{\textbf{#1 ---}}


\begin{document}

\title{Building and Analyzing a 2D DiffuserCam at Home}

\author{Brendan Duke}

\maketitle

\begin{abstract}
\end{abstract}

\section{Introduction}

\begin{itemize}
	\item
\end{itemize}


\section{Method}

\begin{itemize}
	\item Description of gradient descent with FISTA\@.

	\item Description of Alternating Direction Method of Multipliers
	      (ADMM).
\end{itemize}


\section{Experimental Setup}

I converted a PiCam V2 to build my DiffuserCam.
I had to remove the lens, since DiffuserCam is a lensless camera.
Furthermore I had to remove the IR filter and plastic housing for the camera
from the sensor (Fig.~\ref{fig:board-filter-sensor}).
This is because the 2mm focal length of my diffuser,
double-sided tape, was smaller than the thickness of the camera housing itself.
I instead used cardboard as a separating material to place the diffuser at the
correct 2mm focal length from the sensor.

I determined the focal length by analyzing the full width at half maximum
(FWHM) of the autorcorrelation of the recorded point spread function (PSF).

I used a cement mixing tray (Fig.~\ref{fig:experimental-setup}) to provide
a dark environment for calibrating the DiffuserCam.
When taking photos I covered the mixing tray completely so that a single white
LED (also in the tray) was the only light source illuminating the camera
sensor.
I created a pinhole aperture out of cardboard and placed it in front of the LED
to make the LED more closely resemble a point source.
With the tray covered, I read images from the camera in real time.
I adjusted the voltage applied to the LED so that the image pixels did not
saturate, which would violate the linearity assumption made about the PSF in
the reconstruction optimization.
I used the same experimental setup for taking photos of objects to reconstruct.
When reconstructing objects displayed on my phone I adjusted the PiCam exposure
time in order to prevent pixel saturation.


\begin{figure*}[t]
	\centering
	\includegraphics[width=1.0\linewidth]{images/experimental-setup}
	\caption{\label{fig:experimental-setup}
		The experimental setup used to conduct calibration and collect images.
		I used the power supply (bottom) to adjust the brightness of the LED in order to prevent image saturation.}

\end{figure*}



\begin{figure}[t]
	\centering
	\includegraphics[width=1.0\linewidth]{images/board-filter-sensor}
	\caption{\label{fig:board-filter-sensor}
		The Raspberry PiCam V2 camera board, IR filter, and sensor disassembled to create a DiffuserCam.}
\end{figure}



\section{Results}

\begin{itemize}
	\item Autocorrelation of PSF at multiple spacings.

	\item I recorded caustics on the sensor by applying 2.5V to the LED and capturing an image for the default exposure time (Fig.~\ref{fig:caustic}).

	\item I recorded an image under the same conditions but this time with
	      an aperture made of black tape on top of the diffuser
	      (Fig.~\ref{fig:caustic-with-aperture}).

	\item I ran gradient descent (GD) reconstruction of a spiral image displayed
	      on my cell phone
	      (Fig.~\ref{fig:gd-spiral-reconstruction-500iters}).
	      I initialized the GD reconstruction with the raw sensor data
	      (Fig.~\ref{fig:raw-data-spiral}).
	      The reconstruction ran for~\num{500} iterations.
	      The update step uses FISTA~\cite{beck2009fast} and a
	      non-negativity projection.
	      GD reconstructed the spiral image clearly after about 200 epochs.

	\item I ran ADMM reconstruction of the same spiral image on my cell phone
	      (Fig.~\ref{fig:admm-spiral-reconstruction-5iters}).
	      ADMM reconstructed the spiral clearly after only one iteration,
	      starting from the raw sensor data.
	      Successive iterations sharpened the spiral image.
	      However, a regular pattern of artifacts in the image outside the
	      spiral became increasingly apparent.
	      These artifacts appeared in the ADMM reconstruction although at a
	      similarly converged point the GD recsontruction
	      (Fig.~\ref{fig:gd-spiral-reconstruction-500iters}) did not show
	      similar artifacts.

	\item Plot reconstruction error over iterations for both GD and ADMM\@.

	\item Reconstructions of illuminated object.
\end{itemize}


\begin{figure}[t]
	\centering
	\includegraphics[width=1.0\linewidth]{images/caustic}
	\caption{\label{fig:caustic}
		Caustics produced by applying~\num{2.5}V to the LED\@.
		To form this image the sensor was separated by about~\num{2}mm
		of separating material (cardboard) from the diffuser (double-sided tape).
		Qualitatively, the focal length of the diffuser was about~\num{2}mm.}
\end{figure}


\begin{figure}[t]
	\centering
	\includegraphics[width=1.0\linewidth]{images/caustic-with-aperture}
	\caption{\label{fig:caustic-with-aperture}
		Caustics produced by applying~\num{2.5}V to the LED\@.
		Here an aperture made from black tape creates a black border
		around the caustic pattern.
		Without the aperture single-shot calibration would not be
		possible, because new caustics would come into view when the
		point source moves.}
\end{figure}


\begin{figure}[t]
	\centering
	\includegraphics[width=1.0\linewidth]{images/raw-data-spiral}
	\caption{\label{fig:raw-data-spiral}Raw data of the spiral cell phone
		image prior to reconstruction.}
\end{figure}


\begin{figure*}[t]
	\centering
	\includegraphics[width=1.0\linewidth]{images/gd-spiral-reconstruction-500iters}
	\caption{\label{fig:gd-spiral-reconstruction-500iters}
		Gradient descent (GD) reconstruction of a spiral image
		displayed on a cell phone in an otherwise dark environment.
		The update step uses FISTA~\cite{beck2009fast} and a
		non-negativity projection.
		GD reconstructs the spiral image clearly after about 200 epochs.
		The bar on the right side of the spiral is an occlusion from a
		stand holding up the cell phone.}
\end{figure*}


\begin{figure*}[t]
	\centering
	\includegraphics[width=1.0\linewidth]{images/admm-spiral-reconstruction-5iters}
	\caption{\label{fig:admm-spiral-reconstruction-5iters}
		ADMM reconstruction of a spiral image
		displayed on a cell phone in an otherwise dark environment.
		ADMM reconstructs the spiral image clearly after only a single
		iteration.
		The bar on the right side of the spiral is an occlusion from a
		stand holding up the cell phone.}
\end{figure*}



\section{Discussion}

\begin{itemize}
	\item Discussion / analysis about why ADMM produced artifacts and GD
	      did not

	\item Which of ADMM / GD had a lower reconstruction error after
	      convergence?
	      What is the trend?
	      E.g., does GD converge but ADMM diverges?
	      Why?

	\item Analyze the focal distance of the diffuser.

	\item Analyze the linearity and shift invariance of the system.
\end{itemize}



\par\vfill\par

\clearpage
% ---- Bibliography ----
%
% BibTeX users should specify bibliography style 'splncs04'.
% References will then be sorted and formatted in the correct style.
%
{\small
	\bibliographystyle{ieee_fullname}
	\bibliography{report}
}

\clearpage

\end{document}
